<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.1.1">Jekyll</generator><link href="http://localhost:4000/feed.xml" rel="self" type="application/atom+xml" /><link href="http://localhost:4000/" rel="alternate" type="text/html" /><updated>2021-02-18T11:52:14-08:00</updated><id>http://localhost:4000/feed.xml</id><title type="html">ARSN Lab Notebook</title><subtitle>ARSN Lab notebook.</subtitle><entry><title type="html">Scitools Scrublet Function</title><link href="http://localhost:4000/2021/02/18/post-0006.html" rel="alternate" type="text/html" title="Scitools Scrublet Function" /><published>2021-02-18T00:00:00-08:00</published><updated>2021-02-18T00:00:00-08:00</updated><id>http://localhost:4000/2021/02/18/post-0006</id><content type="html" xml:base="http://localhost:4000/2021/02/18/post-0006.html">&lt;p&gt;Load the scitools python environment.
&lt;br /&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;source /home/groups/oroaklab/nishida/scitools_env/bin/activate&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;Link and rename example data.
&lt;br /&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;dir=&quot;/home/groups/oroaklab/adey_lab/projects/Drosophila_Tau/201208_EL_Tau&quot;&lt;/code&gt;
&lt;br /&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;pre=&quot;201208_EL_Tau_all.no_bulk.merge.bbrd.q10.filt.macs3.TSS2plus.filt.RG.dm_peaks.w_bulk_bed.counts&quot;&lt;/code&gt;
&lt;br /&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ln -s ${dir}/${pre}.sparseMatrix.cols.gz cols.gz&lt;/code&gt;
&lt;br /&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ln -s ${dir}/${pre}.sparseMatrix.values.gz values.gz&lt;/code&gt;
&lt;br /&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ln -s ${dir}/${pre}.cistopic.50.UMAP.dims umap.dims&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;Run the scitools function.
&lt;br /&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;scitools matrix_scrublet values.gz cols.gz output_prefix&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;Plot the values onto UMAP.
&lt;br /&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;scitools plot-dims -V output_prefix.doublet_scores.values -S 0,1 umap.dims&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;Example Scrublet distribution figure: &lt;a href=&quot;https://ohsu.app.box.com/file/777868542912&quot;&gt;figure-01&lt;/a&gt;
&lt;br /&gt;Example Scrublet values projected onto UMAP figure: &lt;a href=&quot;https://ohsu.app.box.com/file/777870009592&quot;&gt;figure-02&lt;/a&gt;&lt;/p&gt;</content><author><name></name></author><category term="scitools" /><summary type="html">Load the scitools python environment. source /home/groups/oroaklab/nishida/scitools_env/bin/activate</summary></entry><entry><title type="html">Scitools scATAC Metrics</title><link href="http://localhost:4000/2020/12/17/post-0005.html" rel="alternate" type="text/html" title="Scitools scATAC Metrics" /><published>2020-12-17T00:00:00-08:00</published><updated>2020-12-17T00:00:00-08:00</updated><id>http://localhost:4000/2020/12/17/post-0005</id><content type="html" xml:base="http://localhost:4000/2020/12/17/post-0005.html">&lt;p&gt;&lt;strong&gt;TSS enrichment at a single cell level:&lt;/strong&gt;
&lt;br /&gt;Calculated as the ratio of signal to noise. Signal is defined as the region around TSS +/- 100bp. Noise is defined as the 100bp regions +/- 2000bp from TSS regions that do no overlap with signal. This leads signal and noise being slightly different in size but reads are uniquely counted into a single bin versus other methods where a read can fall into multiple TSS and noise regions. Output is a two-column value file.
&lt;br /&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;scitools bam_tssenrich [bam] [hg38 or mm10 or dm6]&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;TSS enrichment at bulk level, ENCODE:&lt;/strong&gt;
&lt;br /&gt;Calculated via ENCODE standards, &lt;a href=&quot;https://www.encodeproject.org/data-standards/terms/#enrichment&quot;&gt;ENCODE ENRICHMENT&lt;/a&gt;
&lt;br /&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;scitools bam_tssenrich -E [bam] [hg38 or mm10 or dm6]&lt;/code&gt;
&lt;br /&gt;Example enrichment output figure: &lt;a href=&quot;https://ohsu.app.box.com/file/754659307104&quot;&gt;figure-01&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;TSS bulk calculation starts with a bam2bed conversion and is potentially intensive depending on the size of the BAM. A parallelizable version of the bulk TSS calculation can be performed on exacloud.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;TSS enrichment at bulk level, inflated:&lt;/strong&gt;
&lt;br /&gt;This uses a larger distance from TSS sites, larger bins combining more reads, and chooses highest positions via, &lt;a href=&quot;https://www.biorxiv.org/content/10.1101/2020.05.10.087585v1&quot;&gt;this article&lt;/a&gt;
&lt;br /&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;scitools bam_tssenrich -E -r 2000 -n 11 -s MAX [bam] [hg38 or mm10 or dm6]&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;TSS sites are gathered from ENSEMBL and are curated as such:&lt;/strong&gt;
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/home/groups/oroaklab/refs/hg38/ensembl_tss/readme.txt&lt;/code&gt;
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/home/groups/oroaklab/refs/mm10/ensembl_tss/readme.txt&lt;/code&gt;
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/home/groups/oroaklab/refs/dm6/ensembl_tss/readme.txt&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Independent FRIP caller:&lt;/strong&gt;
&lt;br /&gt;This FRIP calculation is divorced from scitools atac_count and is slightly more accurate. The existing FRIP calculation that occurs during matrix generation double-counts reads that overlap multiple peaks.
&lt;br /&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;scitools bam_frip [bam] [bed]&lt;/code&gt;&lt;/p&gt;</content><author><name></name></author><category term="scitools" /><summary type="html">TSS enrichment at a single cell level: Calculated as the ratio of signal to noise. Signal is defined as the region around TSS +/- 100bp. Noise is defined as the 100bp regions +/- 2000bp from TSS regions that do no overlap with signal. This leads signal and noise being slightly different in size but reads are uniquely counted into a single bin versus other methods where a read can fall into multiple TSS and noise regions. Output is a two-column value file. scitools bam_tssenrich [bam] [hg38 or mm10 or dm6]</summary></entry><entry><title type="html">Two Week Update: 2020-11-09</title><link href="http://localhost:4000/2020/11/09/post-0004.html" rel="alternate" type="text/html" title="Two Week Update: 2020-11-09" /><published>2020-11-09T00:00:00-08:00</published><updated>2020-11-09T00:00:00-08:00</updated><id>http://localhost:4000/2020/11/09/post-0004</id><content type="html" xml:base="http://localhost:4000/2020/11/09/post-0004.html">&lt;p&gt;Mosaics - The progress report was finished and the majority of the processing and organization of the data is now complete. There are errors somewhere in the categorical classification of the putative variants and the next step is to figure out from where they are occuring. For this initial pass I have only looked at simplex quad families and now I can take another pass through the scripts and code to work on the multiple quad and trio families. As I’m going through this next pass I will make a more formal writeup and recording of the methods and where everything is located here on this blog.&lt;/p&gt;

&lt;p&gt;SPARK Single Cell / Networks - Start collapsing the original clusters into more discrete groups and get some loose pseudotime analyses done within the larger clusters. Take a look at the actual significance values of the enrichments being performed.&lt;/p&gt;

&lt;p&gt;SciTools Updates - I want to make some quick fixes to beautify the TSS enrichment plots. Also I will add hg19 into the TSS enrichment options. I have some DA updates that can get pushed as well. I also want to do another quick cleaning and updating of the dependencies. And I have handful of code related to paralellizing some operations like creating the matrix and TSS enrichment but I think I will just put them up on this blog rather than pushing them directly into the scitools code (since who knows how we will be using SLURM and exacloud in the future).&lt;/p&gt;

&lt;p&gt;Coussen’s - Get in touch with Christian to see where things were left and pass off the remaining pseudotime analyses.&lt;/p&gt;

&lt;p&gt;Misc - Write up something for the Master’s level job posting. Check in with Sally about the MIP processing. Interview with Ellen. And I’m going to mess around with the Box API because I think moving files from the cluster directly to Box or vice versa would be convenient (gets around having to both download and then upload using my own slower bandwidth).&lt;/p&gt;</content><author><name></name></author><category term="two_week" /><summary type="html">Mosaics - The progress report was finished and the majority of the processing and organization of the data is now complete. There are errors somewhere in the categorical classification of the putative variants and the next step is to figure out from where they are occuring. For this initial pass I have only looked at simplex quad families and now I can take another pass through the scripts and code to work on the multiple quad and trio families. As I’m going through this next pass I will make a more formal writeup and recording of the methods and where everything is located here on this blog.</summary></entry><entry><title type="html">SSC Final Validation Tables with Annotations</title><link href="http://localhost:4000/2020/10/09/post-0002.html" rel="alternate" type="text/html" title="SSC Final Validation Tables with Annotations" /><published>2020-10-09T00:00:00-07:00</published><updated>2020-10-09T00:00:00-07:00</updated><id>http://localhost:4000/2020/10/09/post-0002</id><content type="html" xml:base="http://localhost:4000/2020/10/09/post-0002.html">&lt;p&gt;Directory: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;https://ohsu.app.box.com/folder/81820136345&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;Updated the SSC variant tables to include annotations derived from the columns.&lt;/p&gt;

&lt;p&gt;The biggest discrepancies come from the borderline cases at AF 0.40-0.60 that are hard to call either mosaic or germline. The auto-annotations use the PHET values but can still differ in calls between LCL and WB. Also note that there are cases where it is identified as mosaic parental trans in LCL and mosaic parental nontrans in WB (or vice versa). Twin variant calls in pool 5 do not have twin information in this sheet.&lt;/p&gt;

&lt;p&gt;An issue with these annotations are cases where the mutation shows up in small frequency in a non-main sample. This may be more than error and may be evidence of a trans parental mosaic mutation. We are currently only testing pzero on the main sample with the previously derived allele frequency. We could test for novel mosaics in other samples. For now, I am using a hard cutoff where a mutation must have of an allele frequency &amp;gt; 0.01 (found in 1 of 100 reads).&lt;/p&gt;

&lt;p&gt;Three examples taken from pool 1 where the originally identified mutation was in a child but from this validation could be a parental mosaic. The first two cases are germline in the child and could be parental mosaics. &lt;a href=&quot;https://ohsu.app.box.com/file/728529690028&quot;&gt;figure-01&lt;/a&gt;&lt;/p&gt;</content><author><name></name></author><category term="ssc" /><summary type="html">Directory: https://ohsu.app.box.com/folder/81820136345</summary></entry><entry><title type="html">Two Week Update: 2020-10-09</title><link href="http://localhost:4000/2020/10/09/post-0003.html" rel="alternate" type="text/html" title="Two Week Update: 2020-10-09" /><published>2020-10-09T00:00:00-07:00</published><updated>2020-10-09T00:00:00-07:00</updated><id>http://localhost:4000/2020/10/09/post-0003</id><content type="html" xml:base="http://localhost:4000/2020/10/09/post-0003.html">&lt;p&gt;Mosaic - Read through Deidre’s notes and now have a clear picture of the next steps in collating the data after variant calls. I will first send a draft description of what I believe the next round of summary files should look like. If these seem good I will get them all together across all the data for summarization for the progress report.&lt;/p&gt;

&lt;p&gt;Glial Atlas - Resolved the issue with global TSS enrichments and finished the dimensionality reduction on the full set of data (all peaks and all cells). Will ping Casey to get cluster information for the individual DA’s. Exacloud’s pay structure is changing so we might need to think about a longer-term solution for how to process these larger data sets.&lt;/p&gt;

&lt;p&gt;MIPs - The Friday Illumina run seemed to have died at the tail end. I demuxed everything and gave Sara her share. I need to give Sally a different suite of scripts to deal with the data quality issues of R2 for her processing.&lt;/p&gt;

&lt;p&gt;SSC - New auto-annotations were generated for each pool, manually checked, and I wrote up the few common discrepencies found. This should conclude any changes to the final variant validation tables for the time being.&lt;/p&gt;

&lt;p&gt;CRISPRcapture - The modified tables were finished and I gave some more QC metrics split out by the genome stratifications for sanity checks. Methods writeup was sent to Taylor and I’ll finish a more static summary of where everything is and put it on this blog.&lt;/p&gt;

&lt;p&gt;Spark Networks - Presented some preliminary data fixing the enrichment test and showing the enrichments across the layers/area in addition to age. Similar enrichment patterns across clusters indicate how to best group these clusters together for redoing the enrichments to give us more meaningful results (because everything is enriched currently). Do some qualitative heatmaps and pseudotime-sorted summaries of key genes.&lt;/p&gt;

&lt;p&gt;Coussen’s - Finish pseudotime DA. We will probably have to set up data migration with Google Cloud, which is what they are using instead of exacloud, eventually.&lt;/p&gt;</content><author><name></name></author><category term="two_week" /><summary type="html">Mosaic - Read through Deidre’s notes and now have a clear picture of the next steps in collating the data after variant calls. I will first send a draft description of what I believe the next round of summary files should look like. If these seem good I will get them all together across all the data for summarization for the progress report.</summary></entry><entry><title type="html">Example</title><link href="http://localhost:4000/2020/10/07/post-0001.html" rel="alternate" type="text/html" title="Example" /><published>2020-10-07T00:00:00-07:00</published><updated>2020-10-07T00:00:00-07:00</updated><id>http://localhost:4000/2020/10/07/post-0001</id><content type="html" xml:base="http://localhost:4000/2020/10/07/post-0001.html">&lt;p&gt;Directory: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/home/groups/oroaklab/sample/directory&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;Summary of post. Placeholder sentence. Write descriptions here. Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.&lt;/p&gt;

&lt;p&gt;Description of Figure 1. &lt;a href=&quot;https://ohsu.app.box.com/file/726755681832&quot;&gt;figure-01&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Description of Figure 2. &lt;a href=&quot;https://ohsu.app.box.com/file/726746699799&quot;&gt;figure-02&lt;/a&gt;&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Function example 1:
    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Line 1
Line 2
Line 3
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;Function example 2:
    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Line 1
Line 2
Line 3
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
&lt;/ol&gt;</content><author><name></name></author><category term="general" /><summary type="html">Directory: /home/groups/oroaklab/sample/directory</summary></entry></feed>