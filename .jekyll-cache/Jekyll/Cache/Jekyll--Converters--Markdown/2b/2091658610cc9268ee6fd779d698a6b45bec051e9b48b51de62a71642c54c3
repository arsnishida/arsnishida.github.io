I"³
<p>Directory: <code class="language-plaintext highlighter-rouge">/home/groups/oroaklab/nishida/sc_tmp1/casey_coembed</code></p>

<p>Problem and state. Tests. Coembedding.</p>

<h1 id="tbr1-data-using-caseys-peaks">tbr1 data using caseyâ€™s peaks</h1>
<p>ln -s /home/groups/oroaklab/adey_lab/projects/spatial/wholebrain/wholebrain.bbrd.q10.filt.500.bed .
ln -s /home/groups/oroaklab/adey_lab/projects/tbr1_mus/210225_allplates/tbr1_ko.filt.bai .
ln -s /home/groups/oroaklab/adey_lab/projects/tbr1_mus/210225_allplates/tbr1_ko.filt.bam .
scitools atac-count tbr1_ko.filt.bam wholebrain.bbrd.q10.filt.500.bed
scitools cistopic3 wholebrain.bbrd.q10.filt.500.counts.sparseMatrix.values.gz
scitools matrix-umap wholebrain.bbrd.q10.filt.500.counts.cistopic.50.matrix
scitools plot-dims -O plotdims.devel -p .5 -f .2 -A ../devel.annot wholebrain.bbrd.q10.filt.500.counts.cistopic.50.UMAP.dims
scitools plot-dims -X -O plotdims.TSS -p .5 -f .2 -V ../tbr1_ko.filt.TSSenrich.value -S 0,5 wholebrain.bbrd.q10.filt.500.counts.cistopic.50.UMAP.dims
scitools plot-dims -O plotdims.devel100 -p .5 -f .2 -A ../devel.annot wholebrain.bbrd.q10.filt.500.counts.cistopic.100.UMAP.dims
scitools plot-dims -X -O plotdims.TSS100 -p .5 -f .2 -V ../tbr1_ko.filt.TSSenrich.value -S 0,5 wholebrain.bbrd.q10.filt.500.counts.cistopic.100.UMAP.dims</p>

<h1 id="merged-sparse-matrices-for-full-coembedding-with-cistopics-ultimately-not-used">merged sparse matrices for full coembedding with cistopics, ultimately not used</h1>
<p>ln -s /home/groups/oroaklab/adey_lab/projects/tbr1_mus/210225_allplates/tbr1_ko.filt.500.counts.sparseMatrix.*.gz
scitools matrix-merge-sparse tbr1_ko.filt.500.counts.sparseMatrix.values.gz wholebrain.bbrd.q10.filt.500.counts.sparseMatrix.values.gz</p>

<h1 id="merge-bam-for-full-coembedding-within-archr">merge BAM for full coembedding within ArchR</h1>
<p>scitools bam-merge combined.bam tbr1_ko.filt.bam wholebrain.bbrd.q10.filt.bam</p>

<p>###########</p>

<p><strong>TSS enrichment at bulk level, ENCODE:</strong>
<br />Calculated via ENCODE standards, <a href="https://www.encodeproject.org/data-standards/terms/#enrichment">ENCODE ENRICHMENT</a>
<br /><code class="language-plaintext highlighter-rouge">scitools bam_tssenrich -E [bam] [hg38 or mm10 or dm6]</code>
<br />Example enrichment output figure: <a href="https://ohsu.app.box.com/file/754659307104">figure-01</a></p>

<p><strong>Independent FRIP caller:</strong>
<br />This FRIP calculation is divorced from scitools atac_count and is slightly more accurate. The existing FRIP calculation that occurs during matrix generation double-counts reads that overlap multiple peaks.
<br /><code class="language-plaintext highlighter-rouge">scitools bam_frip [bam] [bed]</code></p>

:ET